package com.cts.cart.controller;

import java.util.HashMap;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;

import com.cts.cart.entity.Cart;
import com.cts.cart.entity.Product;
import com.cts.cart.repository.CartRepository;
import com.cts.cart.service.CartService;

@RestController
@RequestMapping("/api/cart")
public class CartController {

	@Autowired
	private CartRepository cartRepository;
	
	private 

//	@PostMapping("/{user}")
//	public Cart SaveCartItem(@RequestBody Cart cart, @PathVariable String user) {
//
//		RestTemplate restTemplate = new RestTemplate();
//		HashMap<String, Integer> uriVariables = new HashMap<>();
//
//		int id = cart.getItem().getId();
//
//		uriVariables.put("id", id);
//
//		ResponseEntity<Product> entity = restTemplate.getForEntity("http://localhost:8081/api/products/{id}",
//				Product.class, uriVariables);
//
//		Product product = entity.getBody();
//		Product product1 = new Product(product.getName(), product.getPrice(), product.getPrice() * cart.getQty());
//
//		Cart cart1 = new Cart(product1, cart.getQty());
//
//		return service.saveItem(cart1);
//
//	}
	

	@PostMapping("/{name}")
	public Cart saveItemToCart(@RequestBody Cart cart, String name) {

		Product p = cartRepository.findById(id).orElse(null);
		review.setProduct(p);
		return reviewRepository
				.save(new Review(review.getStars(), review.getAuthor(), review.getBody(), review.getProduct()));

	}

}
